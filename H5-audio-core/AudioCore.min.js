"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t="object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"===("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global;"function"==typeof define&&define.amd?define([],function(){t.AudioCore=e()}):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():t.AudioCore=e()}(function(){var e=null,t=null,n=function(e){e=e.slice();for(var t=[];e.length;)t.push(e.splice(Math.floor(Math.random()*e.length),1)[0]);return t},r={loadstart:function(n){t.start&&t.start(e._list[e._cur])},loadedmetadata:function(n){var r=JSON.parse(JSON.stringify(e._list[e._cur]));r.duration=e.duration,t.loaded&&t.loaded(r)},timeupdate:function(n){t.play&&t.play({cur:e.currentTime,total:e.duration})},progress:function(n){for(var r=e.buffered,o=[],i=0;i<r.length;i++)o.push([r.start(i),r.end(i)]);o.length&&t.buffer&&t.buffer(o)},ended:function(n){switch(e._mode){case 1:i.play(e._cur);break;default:i.play_next()}t.end&&t.end(e._list[e._cur])}},o={},i={init:function(o){var u=o.list,a=void 0===u?[]:u,l=o.cur,c=void 0===l?0:l,f=o.mode,d=void 0===f?0:f,s=o.vol,_=void 0===s?.8:s,p=o.play,m=void 0!==p&&p;window.A=e=document.createElement("audio"),t={},e._list=a,e._rand=n(a.map(function(e,t){return t})),e._cur=c,e._mode=d,e.volume=_;for(var v in r)e.addEventListener(v,r[v]);m&&i.play(e._cur)},play:function(t){void 0!==t&&(e.src=e._list[t].src,e._cur=t),e.play()},play_next:function(){var t=e._list.length;switch(e._mode){case 2:var n=e._rand.indexOf(e._cur);n++,n>=t&&(n=0),e._cur=e._rand[n];break;default:e._cur++,e._cur>=t&&(e._cur=0)}i.play(e._cur)},play_pre:function(){var t=e._list.length;switch(e._mode){case 2:var n=e._rand.indexOf(e._cur);n--,n<0&&(n=t-1),e._cur=e._rand[n];break;default:e._cur--,e._cur<0&&(e._cur=t-1)}i.play(e._cur)},vol:function(t){return void 0!==t&&(e.volume=t),e.volume},pause:function(){e.pause()},mode:function(t){e._mode="number"==typeof t?Math.abs(t)%3:0},to_time:function(t){if(e.duration){for(var n=!1,r=e.seekable,o=0;o<r.length;o++)if(t>=r.start(o)&&t<r.end(o)){n=!0;break}n&&(e.currentTime=t)}},on:function(e,n){t[e]="function"==typeof n?n:void 0},info:function(){return{cur:e._cur,vol:e.volume,mode:e._mode,paused:e.paused,duration:e.duration,time:e.currentTime,list:JSON.parse(JSON.stringify(e._list))}},list_add:function(t){e._list.push(t),e._rand.splice(~~(Math.random()*e._list.length),0,e._list.length-1)},list_remove:function(t){t=~~t,t<0||t>=e._list.length||(e._list.splice(t,1),e._rand.splice(e._rand.indexOf(t),1),e._rand=e._rand.map(function(e){return e<t?e:e-1}))},format_time:function(e){e=~~e;var t=e%60,n=~~(e/60);return(n<10?"0"+n:n)+":"+(t<10?"0"+t:t)},set_lrc:function(e){var t={},n=e.split("\n"),r=/\[\d*:\d*((\.|:)\d*)*]/g;return n.forEach(function(e){var n=e.match(r);if(n){var o=e.replace(r,"").trim();n.forEach(function(e){var n=+e.match(/\[\d*/g)[0].slice(1),r=+e.match(/:\d*/g)[0].slice(1);t[60*n+r]=o})}}),o=t,t},cur_lrc:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=Object.keys(t);n.sort(function(e,t){return+e<+t?1:-1});for(var r={},i=0;i<n.length;i++){var u=n[i];if(e>+u){r={time:u,lrc:t[u]};break}}return r}};return i});